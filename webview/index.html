<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <div>
      result:
      <span id="result"></span>
    </div>

    <p>
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
    </p>
  </body>

  <script>
    function detectInApp() {
      const inapp_data = {
        932: [746],
        852: [666],
        926: [752],
        844: [670],
        812: [635, 641],
        667: [559],
        896: [725, 721],
        736: [628],
        568: [460],
      };
      const is_ios_supported = !!navigator.userAgent.match(
        /iPhone OS 15_|iPhone OS 16_|iPhone OS 17_/i
      );
      const is_ios17 = !!navigator.userAgent.match(/iOS 17/i);
      const is_safari =
        !!navigator.userAgent.match(/Safari/i) &&
        !!navigator.userAgent.match(/Mobile/i) &&
        !!navigator.userAgent.match(/Version/i);
      const screen_h = screen.height;
      const window_h = window.innerHeight;
      if (is_ios_supported && is_safari && inapp_data[screen_h].length) {
        if (screen_h == 812 && window_h == 635) return is_ios17; // ambiguity case
        return inapp_data[screen_h].indexOf(window_h) !== -1;
      }
      return null;
    }

    const $result = document.getElementById("result");

    $result.textContent = detectInApp();

    // const standalone = window.navigator.standalone,
    //   userAgent = window.navigator.userAgent.toLowerCase(),
    //   safari = /safari/.test(userAgent),
    //   ios = /iphone|ipod|ipad/.test(userAgent);

    // const innerHeight = window.innerHeight;
    // const outerHeight = window.outerHeight;
    // const clientHeight = document.documentElement.clientHeight;

    // const $window = document.getElementById("window");
    // const $innerHeight = document.getElementById("innerHeight");
    // const $outerHeight = document.getElementById("outerHeight");
    // const $clientHeight = document.getElementById("clientHeight");

    // $window.textContent = JSON.stringify(window.);
    // $innerHeight.textContent = innerHeight;
    // $outerHeight.textContent = outerHeight;
    // $clientHeight.textContent = clientHeight;

    // let res = "";

    // if (ios) {
    //   if (!standalone && safari) {
    //     //browser
    //     res = "browser";
    //   } else if (standalone && !safari) {
    //     //standalone
    //     res = "standalone";
    //   } else if (!standalone && !safari) {
    //     //uiwebview
    //     res = "uiwebview";
    //   }
    // } else {
    //   //not iOS
    //   res = "not iOS";
    // }

    // const $ua = document.getElementById("ua");
    // const $standalone = document.getElementById("standalone");
    // const $external = document.getElementById("external");
    // const $result = document.getElementById("result");

    // $ua.textContent = window.navigator.userAgent.toLowerCase();
    // $standalone.textContent = standalone;
    // $external.textContent = window.external;
    // $result.textContent = res;
  </script>
</html>
